# 分页组件

分页是网页中比较常用的功能，只要有列表存在，就会有分页这样功能。

在后台管理系统，有一个非常重要的组件就是表格，里面会带有分页，我现在写分页就是表格组件里面一个小组件，它可以独立也可以在表格里面使用。

## 写组件需要些什么

1. 配置参数
2. 通用模板
3. 通用行为
4. 通用样式
5. 自定义事件
6. 与其他组件交互

> 根据上面一些要求，总结一句话，组件需要通用，怎么通用，根据配置参数来自定义。

现在用的vue-cli，一个.vue就是一个组件。
## 赶紧上车，开车了
1. 在components新建一个pagination文件夹，在新建一个Pagination.vue文件，这个就是组件文件。
2. 新建一个通用行为的文件getPages.js，尽量吧行为和组件里js分开，便于复用行为逻辑代码。
3. 我参考的[ant.design分页](https://ant.design/components/pagination-cn/)（它用的react实现的，还要一个饿了么组件也是参考它写的，你要问为什么我不直接使用，我下载了饿了么vue组件库，工作可以能用别用的，个人的能自己写的尽量自己，拓展自己思维和眼界。）
4. 里面配置参数，模板，样式，都是按ant.design分页改改。
5. 组件是一个通用的，首先要有一个命名空间，我写css一般都是一套自己总结的[样式规范](https://github.com/jiayisheji/joc), vue提供了一个css隔离属性，它会生成一个随机MD5,加载标签上面，整个组件所有标签都会加，样式都会带上属性查找方式。不说好不好，我不习惯。组件我的命名都是以W开头，那么这个组件就是w-pagination。
6. 东西都准备好了。
## 思考分页的业务行为
1. 分页一般会有一个当前页码。
2. 分页会有总页数
3. 分页会有一页显示多少条
4. 基础页面生成公式： Math.ceil(总页数/条数)（注意：这个时候有小数，小数表示还要列表没有显示全，所以还需要在+1页，即对浮点数向上取整）
5. 有了基础以后需要更多配置，例如上一页，下一页，首页，尾页，
6. 如果页码很多，就需要第一页和最后一页显示在页面上，就省去首页和尾页，因为他们效果类似。
7. 一般分页都是固定显示多少页面，ant.design分页是5个，居中显示，举个栗子（&lt; 1 ... 8 9 `10` 11 12 ... 100 &gt;）解读一下这个栗子表示当前最大页是100，当前页是10，显示5个可见的页面，居中显示，隐藏的页面都以...表示。点击...会前移5个或者后移5个页面。
8. 改变页面条数，如果这个改变就需要从新计算，4-7步。一般一个页面显示10条数据一页。用户可以选择看更多数据，例如20,30,40。这个改变以后还需要事件去通知页面更新数据需要保留对外接口。
9. 每个页码都是可以点击的，会把当前页面传一个处理方式，来重复4-7步，在去告诉页面需要更新数据，请求api从新加载数据，显示给用户。
10. 上一页和下一页需要知道当前页是谁，上一页-1，下一页+1，不能无限加和减，这样就出bug了，需要有边界，如果上一页减到1，就应该停止了，下一页加到最后一页就该停止了。
11. 跳转到某页，有时候页码比较多，一个一个点击很麻烦，就需要给用户一个自己输入数字，点击跳转的入口。需要注意2个东西，一个是只能输入数字，输入数字不能比1小不能大于最大页码，不然就会出现bug。
12. 我们写代码把应该出现bug的地方先考虑一下，别给自己挖坑，留下隐藏bug，坑自己。

## 先思考在干活
> 按整理的思路去一步步写,如果有问题写不下去，就是我们前面思路有问题，需要重新去整理思路，去重新梳理，在重新写代码。虽然前面花时间，后面就是写代码就是爽。

1. 写个模板，一般分页都是ul>li结构，直接copy ant.design分页一份最全的分页模板和样式。一一改造，全部改造成我们想要的逾期的东西，然后先实现一个小目标。让页面显示出来效果。
2. 配置参数

参数 | 说明	| 类型 | 默认值
---|---|---|---
current |	当前页数	| number	| 1
maxSize |	默认的当前页码显示多少个 |	number |	1
total |	数据总数 |	number |	0
pageSize |	每页条数 |	number |	10
onChange |	页码改变的回调，参数是改变后的页码及每页条数 |	Function(page, pageSize) |	noop
showSizeChanger |	是否可以改变pageSize |	boolean |	false
pageSizeOptions |	指定每页可以显示多少条 |	string[] |	['10', '20', '30', '40']
onShowSizeChange |	pageSize变化的回调 |	Function(current, size) |	noop
showQuickJumper |	是否可以快速跳转至某页 |	boolean |	false
size |	当为「small」时，是小尺寸分页 |	string |	""
simple |	当添加该属性时，显示为简单分页 |	boolean |	-
showTotal |	用于显示数据总量和当前数据顺序 |	Function(total, range) |	-

这些都是参考ant.design分页API，减少了一些，改变一些。
3. 配置默认参数，vue提供一个组件默认数据配置接口，这个是一个比较酷的功能，还在默认值和类型检查。
```
props 类型: Array<string> | Object
props: {
  type: （js常用的数据类型）
  default: (根据type来写默认值，不能写其他不一样的类型，就会抛错，别逗)
}
current举栗子：
props: {
  current: {
    type: Number,
    default: 1
  }
}
```
已经有列表了，一个一个按着表格配置。
4. 定义数据，vue提供了一个data对象，来接受组件里面数据交互
```
data 类型： Object | Function
vue限制：组件的定义只接受function
写法：
data () {
  return {
    key: value
  }
}
这里我们需要定义2个数据，一个是一个数组，用来存放所有页面。一个是一个数字变量，当前页码，给上一页和下一页来交互使用的。
```
5. 定义方法，vue提供了一个methods对象，来和组件内绑定方法和事件
```
methods 类型: { [key: string]: Function }
`注意：不应该使用箭头函数来定义 method 函数`
这个坑为什么，请移步[vue文档](http://cn.vuejs.org/v2/api/#methods)
标准写法：
methods: {
  changehandler: function(page){
    // ....
  }
}
```
6. 初始化，获取数据配置数据，vue提供了一个组件的生命周期钩子函数
具体看[文档](http://cn.vuejs.org/v2/api/#beforeCreate)

我们这里就用created这个来获取数据

有哪些数据current，total暂时先用这个

7. vue的工作已经完成了，接下来就要做业务逻辑
根据我们梳理的业务来转化成代码结构
```
1. 需要一个生成分页列表的方法，需要参数（当前页，总页数）对外暴露 
  getPages(currentPage, totalPages)
2. 需要一个配置分页列表的方法，需要参数（配置）对外暴露
  setPageOptions (options)
3. 需要一个配置分页列表对象 私有属性
  pageOptions = {}
```




